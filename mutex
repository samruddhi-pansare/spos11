#include <iostream>
#include <thread>
#include <mutex>
#include <chrono>
using namespace std;

int buffer = 0;             // Shared resource
mutex mtx;                  // Mutex for synchronization

void producer() {
    for(int i=0; i<5; i++) {
        this_thread::sleep_for(chrono::milliseconds(300));
        mtx.lock();
        buffer++;
        cout << "Produced: " << buffer << endl;
        mtx.unlock();
    }
}

void consumer() {
    for(int i=0; i<5; i++) {
        this_thread::sleep_for(chrono::milliseconds(500));
        mtx.lock();
        if(buffer > 0) {
            cout << "Consumed: " << buffer << endl;
            buffer--;
        } else {
            cout << "Buffer empty\n";
        }
        mtx.unlock();
    }
}

int main() {
    thread t1(producer);
    thread t2(consumer);
    t1.join();
    t2.join();
    cout << "Done!" << endl;
    return 0;
}
